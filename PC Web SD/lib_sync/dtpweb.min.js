!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).dtpweb={})}(this,function(n){"use strict";var d,l,h,t,p="GET",c="127.0.0.1",g=15216,r=35216,s=2e3,i=5e3,o=40,a=30,e="黑体",u=3.5,f=.35,y=[.5,.5],v=1.5,P=5,m=20,R=192,O=4096,A="lpapi",C="local",D="DiscoveryPrinters",I="GetPrinters",_="OpenPrinter",L="ClosePrinter",w="IsPrinterOpened",T="IsPrinterOnline",N="GetPrinterName",q="ShowProperty",W="PrintImageD",S="PrintRawData",K="PrintPackage",B="print",H="GetParam",U="SetParam",M="GetItemOrientation",j="SetItemOrientation",F="GetItemHorizontalAlignment",k="SetItemHorizontalAlignment",G="GetItemVerticalAlignment",J="SetItemVerticalAlignment",$="StartJob",V="StartPreview",X="AbortJob",z="CommitJob",Y="GetJobID",Q="GetJobInfo",Z="GetPageInfo",tt="GetPageImage",et="StartPage",nt="EndPage",it="ReturnDrawResult",rt="DrawText",ot="Draw1DBarcode",st="Draw2DQRCode",at="Draw2DPdf417",ut="Draw2DDataMatrix",lt="DrawRectangle",dt="FillRectangle",ht="DrawRoundRectangle",pt="FillRoundRectangle",ct="DrawEllipse",gt="FillEllipse",ft="DrawLine",yt="DrawDashLine",vt="DrawImage",Pt="DrawImageD",mt="ServerInfo",Rt="application/x-www-form-urlencoded;charset=UTF-8",Ot="application/octet-stream;encoding=base64",At="application/json;charset:utf-8",E=(n.LPA_ParamID=void 0,(t=n.LPA_ParamID||(n.LPA_ParamID={}))[t.GapType=1]="GapType",t[t.PrintDarkness=2]="PrintDarkness",t[t.PrintSpeed=3]="PrintSpeed",t[t.PrinterDPI=4]="PrinterDPI",n.LPA_GapType=void 0,(t=n.LPA_GapType||(n.LPA_GapType={}))[t.Unset=255]="Unset",t[t.None=0]="None",t[t.Hole=1]="Hole",t[t.Gap=2]="Gap",t[t.Black=3]="Black",n.LPA_PrintSpeed=void 0,(t=n.LPA_PrintSpeed||(n.LPA_PrintSpeed={}))[t.Unset=255]="Unset",t[t.Min=0]="Min",t[t.Low=1]="Low",t[t.Normal=2]="Normal",t[t.High=3]="High",t[t.Max=4]="Max",n.LPA_PrintDarkness=void 0,(t=n.LPA_PrintDarkness||(n.LPA_PrintDarkness={}))[t.Unset=255]="Unset",t[t.Min=0]="Min",t[t.Low=3]="Low",t[t.Normal=5]="Normal",t[t.High=9]="High",t[t.Max=14]="Max",n.LPA_ItemAlignment=void 0,(t=n.LPA_ItemAlignment||(n.LPA_ItemAlignment={}))[t.Start=0]="Start",t[t.Center=1]="Center",t[t.End=2]="End",t[t.Stretch=3]="Stretch",t[t.Expand=4]="Expand",n.LPA_FontStyle=void 0,(t=n.LPA_FontStyle||(n.LPA_FontStyle={}))[t.Regular=0]="Regular",t[t.Bold=1]="Bold",t[t.Italic=2]="Italic",t[t.BoldItalic=3]="BoldItalic",t[t.Underline=4]="Underline",t[t.Strikeout=8]="Strikeout",0,0,n.LPA_JobNames=void 0,(t=n.LPA_JobNames||(n.LPA_JobNames={})).Preview="#!#Preview#!#",t.Transparent="#!#Transparent#!#",t.Print="dtpweb",n.LPA_PrintActions=void 0,(t=n.LPA_PrintActions||(n.LPA_PrintActions={}))[t.PrintData=1]="PrintData",t[t.PrevBase64=2]="PrevBase64",t[t.PrevUrl=4]="PrevUrl",t[t.Transparent=128]="Transparent",t[t.TransBase64=130]="TransBase64",t[t.Print=4096]="Print",0,(t=d=d||{})[t.OK=0]="OK",t[t.PARAM_ERROR=1]="PARAM_ERROR",t[t.SYSTEM_ERROR=2]="SYSTEM_ERROR",t[t.NOSUPPORTED_PRINTER=3]="NOSUPPORTED_PRINTER",t[t.UNSUPPORTED_PRINTER=4]="UNSUPPORTED_PRINTER",t[t.NOPRINTDATA=5]="NOPRINTDATA",t[t.NOPAGEDIMENSION=6]="NOPAGEDIMENSION",t[t.INVALID_FILE=7]="INVALID_FILE",t[t.UNSUPPORTED_FUNCTION=8]="UNSUPPORTED_FUNCTION",t[t.INVALID_FONTNAME=9]="INVALID_FONTNAME",t[t.NETWORK_FAILD=90]="NETWORK_FAILD",t[t.NETWORK_TIMEOUT=91]="NETWORK_TIMEOUT",t[t.NETWORK_ERROR=92]="NETWORK_ERROR",t[t.NETWORK_ABORT=93]="NETWORK_ABORT",t[t.NETWORK_UNSUPPORT=94]="NETWORK_UNSUPPORT",t[t.NETWORK_EXCEPTION=95]="NETWORK_EXCEPTION",0,0,0,0,0,0,0,(t=l=l||{})[t.Local=1]="Local",t[t.Net=2]="Net",t[t.Wifi=3]="Wifi",0,(t=h=h||{})[t.UrlEncoded=0]="UrlEncoded",t[t.Base64=1]="Base64",t[t.Json=2]="Json",{assignValue:function(t,e){var n,i=t||{};for(n in e)Object.prototype.hasOwnProperty.call(e,n)&&(this.isPlainObject(i[n])&&this.isPlainObject(e[n])?this.assignValue(i[n],e[n]):this.isPlainObject(e[n])?i[n]=this.assignValue({},e[n]):Array.isArray(e[n])?i[n]=e[n].slice():i[n]=e[n]);return i},merge:function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var i=t||{};if(e)for(var r=0;r<e.length;r++)i=this.assignValue(i,e[r]);return i},isObject:function(t){return null!==t&&"object"==typeof t},isPlainObject:function(t){if("[object Object]"!==toString.call(t))return!1;t=Object.getPrototypeOf(t);return null===t||t===Object.prototype},isFunction:function(t){return"[object Function]"===toString.call(t)},isStream:function(t){return this.isObject(t)&&this.isFunction(t.pipe)},isArrayBuffer:function(t){return"[object ArrayBuffer]"===toString.call(t)},isArray:function(t){return Array.isArray?Array.isArray(t):"[object Array]"===Object.prototype.toString.call(t)},isString:function(t){return"string"==typeof t},isNumber:function(t){return"number"==typeof t},isHttpsRequest:function(t){return/https:?/.test(t)},parseArray:function(t,e){void 0===e&&(e=1);var n=[];if(E.isArray(t))return t;if("string"==typeof t)return t.split(",");if("number"==typeof t)for(var i=0;i<e;i++)n.push(t);return n},parseMargin:function(t){var e,n,i=[];return t.margin&&(1===(i=E.parseArray(t.margin,4)).length?i=[i[0],i[0],i[0],i[0]]:2===i.length?i=[i[0],i[1],i[0],i[1]]:3===i.length&&i.push(i[1])),t.marginH&&(n=E.parseArray(t.marginH,2),i[1]=null!=(e=n[0])?e:0,i[3]=null!=(e=n[1])?e:n[0]),t.marginV&&(n=E.parseArray(t.marginV,2),i[0]=null!=(e=n[0])?e:0,i[2]=null!=(t=n[1])?t:n[0]),i},getParamString:function(t){var e,n=[];for(e in t=t||{}){var i=t[e];null!=i&&"object"!=typeof i&&"function"!=typeof i&&n.push("".concat(e,"=").concat(encodeURIComponent(i)))}return 0<n.length?n.join("&"):""},getRequestData:function(t,e){if(null==e?e=[]:"object"!=typeof e&&(e=[e]),e.length&&"object"==typeof e[0])return e[0];var n={};if(!((t="string"==typeof t?[t]:t).length<1)&&t[0])for(var i=0;i<t.length;i++)n[t[i]]=e[i];return n},buildURL:function(t,e){e="string"==typeof e?e:this.getParamString(e);return e?"".concat(t,":").concat(e):t},request:function(t,e){"undefined"!=typeof XMLHttpRequest?this.requestXMLHttp(t,e):"undefined"!=typeof process&&"[object process]"===Object.prototype.toString.call(process)?this.requestNodeHttp(t,e):e({statusCode:d.NETWORK_UNSUPPORT,resultInfo:"not supported http request environment!"})},requestXMLHttp:function(t,e){var n,i=new XMLHttpRequest,r=t.host||c,o=t.port||g,r=t.baseUrl||"http://".concat(r,":").concat(o),s=t.data,a=t.headers,o=(t.url&&"/"===t.url[0]&&(t.url=t.url.substring(1)),"".concat(r,"/").concat(t.url));try{i.open(t.method||p,o,!t.sync),t.timeout&&!t.sync&&(i.timeout=t.timeout);var u=function(){i&&(n=200===i.status?JSON.parse(i.responseText):{statusCode:d.NETWORK_FAILD,resultInfo:i.responseText},e(n),i=null)};if("onloadend"in i?i.onloadend=u:i.onreadystatechange=function(){i&&4===i.readyState&&(0!==i.status||i.responseURL&&0===i.responseURL.indexOf("file:"))&&setTimeout(u)},i.onabort=function(){i&&(e({statusCode:d.NETWORK_ABORT,resultInfo:"Request aborted!"}),i=null)},i.onerror=function(){e({statusCode:d.NETWORK_ERROR,resultInfo:"Network Error"}),i=null},i.ontimeout=function(){e({statusCode:d.NETWORK_TIMEOUT,resultInfo:t.timeout?"timeout of ".concat(t.timeout,"ms exceeded"):"timeout exceeded"}),i=null},a&&"setRequestHeader"in i)for(var l in a)void 0===s&&"content-type"===l.toLowerCase()?delete a[l]:i.setRequestHeader(l,a[l]);i.send(s)}catch(t){e({statusCode:d.NETWORK_EXCEPTION,resultInfo:t})}},requestNodeHttp:function(t,e){var n=require("http"),i=(t.url&&"/"!==t.url[0]&&(t.url="/".concat(t.url)),{host:t.host||c,port:t.port||g,method:t.method||p,path:t.url,headers:t.headers}),r="",o=n.request(i,function(t){t.on("data",function(t){r+=t}),t.on("end",function(){var t={statusCode:d.NETWORK_EXCEPTION,resultInfo:r};try{t=JSON.parse(r)}catch(t){console.log(t)}e(t)}),t.on("error",function(t){n.aborted||e({statusCode:d.NETWORK_ERROR,resultInfo:t})})});o.on("error",function(t){e({statusCode:d.NETWORK_FAILD,resultInfo:t})}),o.on("socket",function(t){t.setKeepAlive(!0,6e4)}),t.timeout&&(i=t.timeout,o.setTimeout(i,function(){o.destroy(),e({statusCode:d.NETWORK_TIMEOUT,resultInfo:t.timeout?"timeout of ".concat(t.timeout,"ms exceeded"):"timeout exceeded"})})),o.end(t.data)},unitConvert:function(t){return t&&100*t},poundToMm:function(t){return 25.4*t/72},mmToPound:function(t){return 72*t/25.4},unitConvertOfDrawBase:function(t,e){var e=e||[],n=e[3]||0,i=e[0]||0,r=e[4]||0,e=e[5]||0,o=(t=t||{}).x||0,s=t.y||0;return t.x=this.unitConvert(o+n+r),t.y=this.unitConvert(s+i+e),t.width=this.unitConvert(t.width),t.height=this.unitConvert(t.height),t.orientation&&3<t.orientation&&(t.orientation=t.orientation/90),t},unitConvertOfFillRect:function(t,e){return(t=this.unitConvertOfDrawBase(t,e)).width=t.width||this.unitConvert(m),t.height=t.height||t.width,t.cornerWidth=this.unitConvert(t.cornerWidth),t.cornerHeight=this.unitConvert(t.cornerHeight)||t.cornerWidth,t},unitConvertOfDrawRect:function(t,e){return(t=this.unitConvertOfFillRect(t,e)).lineWidth=this.unitConvert(t.lineWidth||f),t},unitConvertOfLine:function(t,e){var e=e||[],n=e[3]||0,i=e[0]||0,r=e[4]||0,e=e[5]||0,o=(t=t||{}).x1||0,s=t.y1||0,a=null!=(a=t.x2)?a:o,u=null!=(u=t.y2)?u:s;if(t.x1=this.unitConvert(o+n+r),t.y1=this.unitConvert(s+i+e),t.x2=this.unitConvert(a+n+r),t.y2=this.unitConvert(u+i+e),t.lineWidth=this.unitConvert(t.lineWidth||f),!t.dashLens&&E.isArray(t.dashLen)?(t.dashLens=t.dashLen,t.dashLen=void 0):t.dashLen||"string"!=typeof t.dashLens||(t.dashLen=t.dashLens,t.dashLens=void 0),"string"==typeof t.dashLen&&(t.dashLens=t.dashLen.split(",")),t.dashLens&&0<t.dashLens.length){1===t.dashLens.length&&t.dashLens.push(t.dashLens[0]);for(var l=0;l<t.dashLens.length;l++)t.dashLens[l]=this.unitConvert(t.dashLens[l]);t.dashLen=t.dashLens.join(","),t.dashCount=t.dashLens.length}return t.orientation&&3<t.orientation&&(t.orientation=t.orientation/90),t},getTimeout:function(t,e){return t&&0<t?t:e===l.Local?s:i},getAgent:function(){return navigator.userAgent.toLowerCase()||""},isWin32:function(){var t=this.getAgent();return t.indexOf("win32")||t.indexOf("wow32")},isWin64:function(){var t=this.getAgent();return t.indexOf("win64")||t.indexOf("wow64")},isWindows:function(){var t=this.getAgent();return 0<=t.indexOf("win")||0<=t.indexOf("wow")},isMac:function(){return/macintosh|mac os x/i.test(this.getAgent())}}),b=void 0;function x(){this._labelWidth=0,this._labelHeight=0,this._margins=[]}x.getApi=function(e){return this.getInstance(e).checkPlugin(function(t){e&&"function"==typeof e.callback&&e.callback(t)}),this.getInstance()},x.getInstance=function(t){var e=b=b||new x;return e.init(t),e},x.prototype.getIpAddress=function(t){return t||this._ip||this._initIp},x.prototype.getPort=function(t){return t||this._port||this._initPort},x.prototype.getDeviceType=function(t){return t||this._deviceType||l.Local},x.prototype.getFontName=function(t){return t||this._fontName||e},x.prototype.getFontHeight=function(t){return t||this._fontHeight||u},x.prototype.getLineWidth=function(t){return t||this._lineWidth||f},x.prototype.getRadius=function(t){return t||this._radius||P},x.prototype.getCornerWidth=function(t){return t||this._cornerWidth||v},x.prototype.parseMargin=function(t){this._margins.splice(0);for(var e=E.parseMargin(t),n=0;n<4;n++)this._margins[n]=+(e[n]||0);return this._margins},x.prototype.setFontName=function(t){this._fontName=t},x.prototype.setOffsetX=function(t){this._margins[4]=t},x.prototype.setOffsetY=function(t){this._margins[5]=t},x.prototype.init=function(t){t=t||{};t.ip&&(this._initIp=t.ip),t.fontName&&(this._fontName=t.fontName),t.fontHeight&&(this._fontHeight=t.fontHeight),t.lineWidth&&(this._lineWidth=t.lineWidth),t.radius&&(this._radius=t.radius)},x.prototype.checkPlugin=function(e){function n(t){console.log(t?"★★★ 打印助手运行正常 ★★★":"★★★ 未检测到打印助手 ★★★"),e&&e(t)}var i=this;this.checkPort(g,function(t){t?n(i):i.checkPort(r,n)})},x.prototype.checkPort=function(n,i){var r=this,o=(console.log("$$$$ DTPWEB request: checkPort $$$$"),this._initIp||c);b=b||this,E.request({host:o,port:n||this._port,url:"".concat(C,"/").concat(mt),sync:!1,timeout:s},function(t){console.log("## onResponse: checkPlugin ##"),console.log(t);function e(t){"function"==typeof i&&i(t)}t&&t.statusCode<d.NETWORK_FAILD?(r._initIp||(r._initIp=o),n&&(r._initPort=n),e(r)):e(void 0)})},x.prototype.requestApi=function(t,e){void 0===e&&(e={});var n=E.getRequestData(["action"],[t]),t=(console.log("$$$$ DTPWEB request: ".concat(n.action," $$$$")),console.log(e||n.data||n),e=e||{},n.data||e.data),i=(e.data&&(e.data=void 0),E.getParamString(n.params||e)),r=i?"?".concat(i):"",o=n.control||A,s=this.getDeviceType(n.deviceType),a=E.getTimeout(n.timeout,s),u=void 0,i=(n.contentType===h.Json?t=JSON.stringify(t||e):n.contentType!==h.Base64&&(t=i),Rt);return n.contentType===h.Json?i=At:n.contentType===h.Base64&&(i=Ot),E.request({method:"POST",host:this.getIpAddress(s===l.Local?void 0:n.ip),port:this.getPort(n.port),url:"".concat(o,"/").concat(n.action).concat(r),params:e,headers:{"Content-type":i},data:t,sync:!0,timeout:a},function(t){console.log("## onResponse: ".concat(n.action," ##")),console.log(t),u=t}),u},x.prototype.getItemOrientation=function(){var t=this.requestApi(M);return null==t?void 0:t.resultInfo},x.prototype.setItemOrientation=function(t){t=E.getRequestData(["orientation"],[t]),t=this.requestApi(j,t);return(null==t?void 0:t.statusCode)===d.OK},x.prototype.getItemHorizontalAlignment=function(){var t=this.requestApi(F);return null==t?void 0:t.resultInfo},x.prototype.setItemHorizontalAlignment=function(t){t=E.getRequestData(["alignment"],[t]),t=this.requestApi(k,t);return(null==t?void 0:t.statusCode)===d.OK},x.prototype.getItemVerticalAlignment=function(){var t=this.requestApi(G);return null==t?void 0:t.resultInfo},x.prototype.setItemVerticalAlignment=function(t){t=E.getRequestData(["alignment"],[t]),t=this.requestApi(J,t);return(null==t?void 0:t.statusCode)===d.OK},x.prototype.discoveryPrinters=function(t){t=this.requestApi(D,{mode:null!=t?t:1});return(null==t?void 0:t.statusCode)===d.OK},x.prototype.getPrinters=function(t){(t=E.getRequestData(["onlyOnline"],[t])).onlyOnline="boolean"!=typeof t.onlyOnline||t.onlyOnline,t.onlySupported=!0;var t=this.requestApi({action:I,timeout:5e3},t);return(null==(t=null==t?void 0:t.resultInfo)?void 0:t.printers)||[]},x.prototype.openPrinter=function(t){var e=E.getRequestData(["name"],arguments),n=this.requestApi({action:_,ip:e.ip||this._initIp,port:e.port||this._initPort,deviceType:e.type||l.Local,timeout:1e4},e);return(null==n?void 0:n.statusCode)===d.OK&&(e.type&&e.type!==l.Local&&(this._ip=e.ip,this._port=e.port,this._deviceType=e.type),!0)},x.prototype.getPrinterName=function(){var t;return null==(t=this.requestApi(N))?void 0:t.resultInfo},x.prototype.isPrinterOpened=function(){var t;return(null==(t=this.requestApi(w))?void 0:t.statusCode)===d.OK},x.prototype.isPrinterOnline=function(){var t;return!!E.isWindows()&&(null==(t=this.requestApi(T))?void 0:t.statusCode)===d.OK},x.prototype.closePrinter=function(){var t;return(null==(t=this.requestApi(L))?void 0:t.statusCode)===d.OK},x.prototype.showProperty=function(t){var e;return E.isWindows()&&(t.showDocument="boolean"!=typeof t.showDocument||t.showDocument,e=this.requestApi(q,t)),(null==e?void 0:e.statusCode)===d.OK},x.prototype.getParam=function(t){t=E.getRequestData(["id"],[t]),t=this.requestApi(H,t);return(null==t?void 0:t.statusCode)===d.OK?t.resultInfo:-1},x.prototype.setParam=function(t){t=E.getRequestData(["id","value"],arguments);t=this.requestApi(U,t);return(null==t?void 0:t.statusCode)===d.OK},x.prototype.getGapType=function(){return this.getParam(n.LPA_ParamID.GapType)},x.prototype.setGapType=function(t){return this.setParam({id:n.LPA_ParamID.GapType,value:t})},x.prototype.getPrintDarkness=function(){return this.getParam(n.LPA_ParamID.PrintDarkness)},x.prototype.setPrintDarkness=function(t){return this.setParam({id:n.LPA_ParamID.PrintDarkness,value:t})},x.prototype.getPrintSpeed=function(){return this.getParam(n.LPA_ParamID.PrintSpeed)},x.prototype.setPrintSpeed=function(t){return this.setParam({id:n.LPA_ParamID.PrintSpeed,value:t})},x.prototype.getPrinterDPI=function(){return this.getParam(n.LPA_ParamID.PrinterDPI)},x.prototype.startJob=function(t){t=E.getRequestData(["width","height","orientation","jobName"],arguments);var e=this.parseMargin(t),e=(this._labelWidth=t.width||o,this._labelHeight=t.height||a,t.scaleUnit=1,t.width=E.unitConvert(t.width+e[1]+e[3]),t.height=E.unitConvert(t.height+e[0]+e[2]),t.jobName=t.jobName||n.LPA_JobNames.Print,this.requestApi($,t));return(null==e?void 0:e.statusCode)===d.OK},x.prototype.startPreview=function(t){t=E.getRequestData(["width","height","orientation","backgroundMode"],arguments),this._labelWidth=t.width||o,this._labelHeight=t.height||a,t.scaleUnit=1,t.width=E.unitConvert(t.width),t.height=E.unitConvert(t.height);t=this.requestApi(V,t);return(null==t?void 0:t.statusCode)===d.OK},x.prototype.abortJob=function(){this.requestApi(X)},x.prototype.commitJob=function(t){t=this.requestApi(z,t);return(null==t?void 0:t.statusCode)===d.OK},x.prototype.getJobID=function(){var t;return E.isWindows()?null==(t=this.requestApi(Y))?void 0:t.resultInfo:0},x.prototype.getJobInfo=function(t){if(E.isWindows())return null==(t=this.requestApi(Q,t))?void 0:t.resultInfo},x.prototype.getPageInfo=function(){var t=this.requestApi(Z);return null==t?void 0:t.resultInfo},x.prototype.getPageImage=function(t){t=E.getRequestData(["page","format"],arguments);t=this.requestApi(tt,t);return null==t?void 0:t.resultInfo},x.prototype.startPage=function(){var t;return(null==(t=this.requestApi(et))?void 0:t.statusCode)===d.OK},x.prototype.endPage=function(){var t;return(null==(t=this.requestApi(nt))?void 0:t.statusCode)===d.OK},x.prototype.returnDrawResult=function(t){var t=E.getRequestData(["returnDrawResult"],[t]),e=(t.returnDrawResult=null==(e=t.returnDrawResult)||e,this.requestApi(it,t));return(null==e?void 0:e.statusCode)===d.OK},x.prototype.mm2Pound=function(t){return E.mmToPound(t)},x.prototype.pound2Mm=function(t){return E.poundToMm(t)},x.prototype.drawText=function(t){if(!(t=E.getRequestData(["text","x","y","width","height","fontHeight","fontStyle"],arguments)).text)return!1;if(t.fontHeight=this.getFontHeight(t.fontHeight||t.height),(t=E.unitConvertOfDrawBase(t,this._margins)).fontName=this.getFontName(t.fontName),t.fontHeight=E.unitConvert(t.fontHeight),t.charSpace=E.unitConvert(t.charSpace),"number"==typeof t.lineSpace&&(t.lineSpace=E.unitConvert(t.lineSpace)),t.leadingIndent||(t.leadingIndentChars?(t.leadingIndent=10*t.leadingIndentChars,delete t.leadingIndentChars):t.leadingIndentMM?(.01<=t.leadingIndentMM?t.leadingIndent=100*t.leadingIndentMM+1e3:t.leadingIndentMM<=-.01&&(t.leadingIndent=100*t.leadingIndentMM-1e3),delete t.leadingIndentMM):t.leadingIndentColon&&(t.leadingIndent=1e3,delete t.leadingIndentColon)),0===t.leadingIndent&&delete t.leadingIndent,Array.isArray(t.regionCorners)){for(var e=0;e<t.regionCorners.length;e++)t.regionCorners[e]=E.unitConvert(t.regionCorners[e]);t.regionCorners=t.regionCorners.join(",")}if(!t.regionCorners){var n=[];if(t.regionLeftUpCorner&&(n[0]=t.regionLeftUpCorner,delete t.regionLeftUpCorner),t.regionRightUpCorner&&(n[1]=t.regionRightUpCorner,delete t.regionRightUpCorner),t.regionRightBottomCorner&&(n[2]=t.regionRightBottomCorner,delete t.regionRightBottomCorner),t.regionLeftBottomCorner&&(n[3]=t.regionLeftBottomCorner,delete t.regionLeftBottomCorner),0<n.length){for(var i=[],e=0;e<4;e++){var r=n[e];if("string"==typeof r&&(r=r.split(",")),i[e]="0,0",Array.isArray(r)){2<r.length&&(r=r.slice(0,2));for(var o=0;o<2;o++)r[o]=E.unitConvert(r[o]||0);i[e]=r.join(",")}}t.regionCorners=i.join(",")}}if(t.regionLeftBorders){var s=t.regionLeftBorders;if("string"==typeof t.regionLeftBorders&&(s=t.regionLeftBorders.split(",")),Array.isArray(s)&&2<s.length){for(e=0;e<s.length;e++)s[e]=E.unitConvert(s[e]);t.regionLeftBorders=s.join(",")}else delete t.regionLeftBorders}if(t.regionRightBorders)if("string"==typeof(s=t.regionRightBorders)&&(s=s.split(",")),Array.isArray(s)&&2<s.length){for(e=0;e<s.length;e++)s[e]=E.unitConvert(s[e]);t.regionRightBorders=s.join(",")}else delete t.regionRightBorders;var a=this.requestApi(rt,t);return(null==a?void 0:a.statusCode)===d.OK},x.prototype.draw1DBarcode=function(t){if(!(t=E.getRequestData(["text","x","y","width","height","textHeight"],arguments)).text)return!1;(t=E.unitConvertOfDrawBase(t,this._margins)).textHeight=E.unitConvert(t.textHeight),t.textBarSpace=E.unitConvert(t.textBarSpace),t.fontName=this.getFontName(t.fontName);t=this.requestApi(ot,t);return(null==t?void 0:t.statusCode)===d.OK},x.prototype.draw2DQRCode=function(t){if(!(t=E.getRequestData(["text","x","y","width","height","eccLevel"],arguments)).text)return!1;(t=E.unitConvertOfDrawBase(t,this._margins)).height||(t.height=t.width);t=this.requestApi(st,t);return(null==t?void 0:t.statusCode)===d.OK},x.prototype.draw2DPdf417=function(t){if(!(t=E.getRequestData(["text","x","y","width","height"],arguments)).text)return!1;t=E.unitConvertOfDrawBase(t,this._margins);t=this.requestApi(at,t);return(null==t?void 0:t.statusCode)===d.OK},x.prototype.draw2DDataMatrix=function(t){if(!(t=E.getRequestData(["text","x","y","width","height"],arguments)).text)return!1;t=E.unitConvertOfDrawBase(t,this._margins);t=this.requestApi(ut,t);return(null==t?void 0:t.statusCode)===d.OK},x.prototype.drawRectangle=function(t){if((t=E.getRequestData(["x","y","width","height","lineWidth"],arguments)).fill)return this.fillRectangle(t);if(t.cornerWidth||t.cornerHeight)return this.drawRoundRectangle(t);t.lineWidth=this.getLineWidth(t.lineWidth),t=E.unitConvertOfDrawRect(t,this._margins);t=this.requestApi(lt,t);return(null==t?void 0:t.statusCode)===d.OK},x.prototype.fillRectangle=function(t){if((t=E.getRequestData(["x","y","width","height"],arguments)).cornerWidth||t.cornerHeight)return this.fillRoundRectangle(t);t=E.unitConvertOfFillRect(t,this._margins);t=this.requestApi(dt,t);return(null==t?void 0:t.statusCode)===d.OK},x.prototype.drawRoundRectangle=function(t){if((t=E.getRequestData(["x","y","width","height","cornerWidth","lineWidth"],arguments)).fill)return this.fillRoundRectangle(t);t.cornerWidth=this.getCornerWidth(t.cornerWidth||t.cornerHeight),t.lineWidth=this.getLineWidth(t.lineWidth),t=E.unitConvertOfDrawRect(t,this._margins);t=this.requestApi(ht,t);return(null==t?void 0:t.statusCode)===d.OK},x.prototype.fillRoundRectangle=function(t){(t=E.getRequestData(["x","y","width","height","cornerWidth"],arguments)).cornerWidth=this.getCornerWidth(t.cornerWidth||t.cornerHeight),t=E.unitConvertOfFillRect(t,this._margins);t=this.requestApi(pt,t);return(null==t?void 0:t.statusCode)===d.OK},x.prototype.drawEllipse=function(t){if((t=E.getRequestData(["x","y","width","height","lineWidth"],arguments)).fill)return this.fillEllipse(t);t.lineWidth=this.getLineWidth(t.lineWidth),t=E.unitConvertOfDrawRect(t,this._margins);t=this.requestApi(ct,t);return(null==t?void 0:t.statusCode)===d.OK},x.prototype.fillEllipse=function(t){t=E.getRequestData(["x","y","width","height"],arguments),t=E.unitConvertOfFillRect(t,this._margins);t=this.requestApi(gt,t);return(null==t?void 0:t.statusCode)===d.OK},x.prototype.drawCircle=function(t){(t=E.getRequestData(["x","y","radius","lineWidth"],arguments)).fill&&this.fillCircle(t);var e=this.getRadius(t.radius),n=2*e,i=(delete t.radius,t);return i.x=(t.x||0)-e,i.y=(t.y||0)-e,i.width=i.height=n,this.drawEllipse(i)},x.prototype.fillCircle=function(t){t=E.getRequestData(["x","y","radius"],arguments);var e=this.getRadius(t.radius),n=2*e,i=t;return i.x=(t.x||0)-e,i.y=(t.y||0)-e,i.width=i.height=n,delete t.radius,this.fillEllipse(i)},x.prototype.drawLine=function(t){if(0<((t=E.getRequestData(["x1","y1","x2","y2","lineWidth"],arguments)).dashLens||t.dashLen||[]).length)return this.drawDashLine(t);t.lineWidth=this.getLineWidth(t.lineWidth),t=E.unitConvertOfLine(t,this._margins);t=this.requestApi(ft,t);return(null==t?void 0:t.statusCode)===d.OK},x.prototype.drawDashLine=function(t){((t=E.getRequestData(["x1","y1","x2","y2","dashLen","lineWidth"],arguments)).dashLen||t.dashLens||[]).length<1&&(t.dashLens=y),t.lineWidth=this.getLineWidth(t.lineWidth),t=E.unitConvertOfLine(t,this._margins);t=this.requestApi(yt,t);return(null==t?void 0:t.statusCode)===d.OK},x.prototype.drawImage=function(t){if(!(t=E.getRequestData(["imageFile","x","y","width","height"],arguments)).imageFile)return!1;t=E.unitConvertOfDrawBase(t,this._margins);t=this.requestApi(vt,t);return(null==t?void 0:t.statusCode)===d.OK},x.prototype.drawImageD=function(t){if(!(t=E.getRequestData(["data","x","y","drawWidth","drawWidth"],arguments)).data)return!1;t.threshold=null!=(e=t.threshold)?e:R,(t=E.unitConvertOfDrawBase(t,this._margins)).drawWidth=E.unitConvert(t.drawWidth||this._labelWidth),t.drawHeight=E.unitConvert(t.drawHeight||this._labelHeight);var e=this.requestApi({action:Pt,contentType:h.Base64,data:t.data},t);return(null==e?void 0:e.statusCode)===d.OK},x.prototype.printImage=function(t){if(!(t=E.getRequestData(["data","printerName"],arguments)).data)return!1;t.scaleUnit=1,t.printWidth=E.unitConvert(t.printWidth),t.printHeight=E.unitConvert(t.printHeight),t.threshold=null!=(e=t.threshold)?e:R,t.jobName=t.jobName||n.LPA_JobNames.Print;var e=this.requestApi({action:W,contentType:h.Base64,data:t.data},t);return!!e&&e.statusCode===d.OK},x.prototype.printRawData=function(t){if(!(t=E.getRequestData(["data"],arguments)).data)return!1;t=this.requestApi(S,t);return!!t&&t.statusCode===d.OK},x.prototype.printPackage=function(t){if(!(t=E.getRequestData(["data"],[t])).data)return!1;t=this.requestApi(K,t);return!!t&&t.statusCode===d.OK},x.prototype.print=function(t){var e;if(t&&t.jobPages)return e=t.action||O,t.action&&delete t.action,e=this.requestApi({action:B,contentType:h.Json,params:{action:e},data:t}),e&&e.statusCode===d.OK?e.resultInfo:void 0},n.DTPWeb=x,Object.defineProperty(n,"__esModule",{value:!0})});
